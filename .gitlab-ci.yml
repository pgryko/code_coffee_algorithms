# use the official gcc image, based on debian
# can use verions as well, like gcc:5.2
# see https://hub.docker.com/_/gcc/
image: gcc

# Is performed before the scripts in the stages step
before_script:
  - apt-get update
  - apt-get -y install cmake python3-pip
  - git submodule update --init --recursive
#  - pip3 install --upgrade pip wheel setuptools
# Defines stages which are to be executed


test cpp:
  stage: build
    script:
    - cmake -H. -Bbuild
    - cd build;
    - make
  stage: test
  script:
    - cd build;
    - ./unit_tests --gtest_output="xml:cpp_junit.xml"

  artifacts:
    reports:
      junit:
       - build/cpp_junit.xml

test python:
  stage: build
    script:
    - pip3 install -r requirements.txt
  stage: test
  script:
    - pytest --junitxml=build/pytest.xml --cov=src/
  artifacts:
    reports:
      junit:
       - build/pytest.xml
